<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic Division Game!</title>
    <style>
        /* Previous styles remain the same */
        .answer-input {
            width: 40px;
            height: 40px;
            font-size: 24px;
            text-align: center;
            border: 2px solid #333;
            border-radius: 4px;
            font-family: 'Comic Sans MS', cursive;
            background: white;
        }

        .answer-input.correct {
            background-color: #90EE90;
            border-color: #4CAF50;
        }

        #dividend {
            position: absolute;
            left: 235px;
            top: 150px;
            font-size: 24px;
            display: flex;
            gap: 20px;
        }

        #divisor {
            position: absolute;
            left: 190px;
            top: 150px;
            font-size: 24px;
        }

        .division-line {
            position: absolute;
            background-color: black;
            height: 2px;
            left: 225px;
            top: 140px;
        }

        /* Add helper text styling */
        #helper-text {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Previous HTML remains the same -->
    
    <script>
        class DivisionGame {
            constructor() {
                this.score = 0;
                this.streak = 0;
                this.highScore = parseInt(localStorage.getItem('highScore')) || 0;
                this.level = 1;
                this.timeLeft = 60;
                this.answerBoxes = [];
                this.fullAnswer = '';
                this.dividend = 0;
                this.divisor = 0;
                this.problemHistory = [];
                this.currentProblemIndex = -1;
                this.timer = null;
                
                this.initializeGame();
                this.setupEventListeners();
                this.startTimer();
                this.updateStats();
            }

            generateProblem() {
                // Generate divisor (2-12 for easier problems)
                const divisor = Math.floor(Math.random() * 11) + 2;
                
                // Generate dividend digits (ensuring each step is divisible)
                let dividendDigits = [];
                let quotientDigits = [];
                
                // First digit must be divisible and non-zero
                let firstDividendDigit;
                do {
                    firstDividendDigit = Math.floor(Math.random() * 9) + 1;
                } while (firstDividendDigit < divisor);
                
                dividendDigits.push(firstDividendDigit);
                quotientDigits.push(Math.floor(firstDividendDigit / divisor));
                
                // Generate 2-3 more digits
                const totalDigits = Math.floor(Math.random() * 2) + 2; // 2-3 total digits
                
                for (let i = 1; i < totalDigits; i++) {
                    // Generate a number that works with the divisor
                    const nextDividendDigit = Math.floor(Math.random() * 10);
                    dividendDigits.push(nextDividendDigit);
                }
                
                // Calculate the actual division
                const dividend = parseInt(dividendDigits.join(''));
                const fullQuotient = Math.floor(dividend / divisor);
                
                // Ensure the quotient has the correct number of digits including leading/middle zeros
                const paddedQuotient = String(fullQuotient).padStart(totalDigits, '0');
                
                return {
                    dividend: dividend,
                    divisor: divisor,
                    quotient: paddedQuotient
                };
            }

            drawProblem() {
                // Add helper text
                const helperText = document.getElementById('helper-text') || document.createElement('div');
                helperText.id = 'helper-text';
                helperText.textContent = 'Fill in each digit of the quotient, including any zeros!';
                document.getElementById('problem-area').appendChild(helperText);
                
                // Update display
                document.getElementById('divisor').textContent = this.divisor;
                const dividendContainer = document.getElementById('dividend');
                dividendContainer.innerHTML = String(this.dividend)
                    .split('')
                    .map(digit => `<span class="dividend-digit">${digit}</span>`)
                    .join('');
                
                // Adjust line width based on dividend length
                const lineWidth = String(this.dividend).length * 60;
                const divisionLine = document.querySelector('.division-line');
                divisionLine.style.width = `${lineWidth}px`;

                this.createAnswerBoxes();
            }

            checkDigit(event, position) {
                const input = event.target;
                let value = input.value;

                if (!value) return;

                // Ensure single digit
                if (value.length > 1) {
                    input.value = value[0];
                    value = value[0];
                }

                // Validate digit
                if (!/^\d$/.test(value)) {
                    input.value = '';
                    return;
                }

                // Check if digit matches expected quotient (including zeros)
                if (value === this.fullAnswer[position]) {
                    input.classList.add('correct');
                    if (position < this.answerBoxes.length - 1) {
                        this.answerBoxes[position + 1].focus();
                    }

                    if (this.checkAllCorrect()) {
                        this.handleCorrectAnswer();
                    }
                } else {
                    input.value = '';
                    this.handleWrongAnswer();
                }
            }

            // Previous methods remain the same
        }

        // Start the game
        window.onload = () => {
            new DivisionGame();
        };
    </script>
</body>
</html>